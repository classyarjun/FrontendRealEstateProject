<div class="wrapper">
  <!-- Sidebar navbar -->
  <nav *ngIf="isVisible" id="sidebar" class="bg-light border-dark">
    <div class="sidebar-header p-3">
      <div class="d-flex align-items-center flex-column">
        
        <div *ngIf="agentData">
          <img [src]="getProfileImage()" alt="Profile Picture" class="profile-picture" width="100" height="100" />
          <div class="p-2">
            <h6 class="">{{ agentData.fullName  }}</h6>
            <small class="text-muted">Agent Dashboard</small>
          </div>
        </div>

      </div>
    </div>

    <div class=" ">
      <ul class="nav flex-column nav-tabs mx-3" role="tablist">
        <li class="nav-item">
          <a class="nav-link active fw-bold" data-bs-toggle="tab" href="#Dashboard" role="tab">
            <i class="bi bi-house-door text-danger"></i>
            <span>Dashboard</span>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link fw-bold" data-bs-toggle="tab" href="#Property" role="tab">
            <i class="bi bi-map"></i>
            <span>Property</span>
          </a>
        </li>
      </ul>
    </div>
  </nav>

  <!-- Page Content  section -->
  <div id="content">
    <!-- Top navbar  in content section-->
    <nav class="navbar navbar-expand-lg bg-light shadow-sm">
      <div class="container-fluid">
        <button type="button" (click)="toggle()" class="btn btn-dark btn-sm">
          <i class="bi bi-list"></i>
        </button>
        <button class="btn btn-outline-dark btn-sm" (click)="logout()">
          <i class="bi bi-person"></i>
          LogOut
        </button>
      </div>
    </nav>

    <!-- Main content  content section-->
    <div class="container-fluid">
      <div class="tab-content">
        <!-- Dashboard Tab -->
        <div class="tab-pane fade show active" id="Dashboard" role="tabpanel">
          <div class="mt-4">
            <h3 class="mb-4">Real Estate Overview</h3>
            <div class="row">
              <div class="col-md-3 mb-4">
                <div class="card text-white bg-dark">
                  <div class="card-body">
                    <h5 class="card-title">Total Properties</h5>
                    <p class="card-text display-4">156</p>
                  </div>
                </div>
              </div>
              <div class="col-md-3 mb-4">
                <div class="card text-white bg-danger">
                  <div class="card-body">
                    <h5 class="card-title">Properties Sold</h5>
                    <p class="card-text display-4">42</p>
                  </div>
                </div>
              </div>
              <div class="col-md-3 mb-4">
                <div class="card text-white bg-success">
                  <div class="card-body">
                    <h5 class="card-title">New Listings</h5>
                    <p class="card-text display-4">8</p>
                  </div>
                </div>
              </div>
              <div class="col-md-3 mb-4">
                <div class="card text-white bg-warning">
                  <div class="card-body">
                    <h5 class="card-title">Pending Sales</h5>
                    <p class="card-text display-4">15</p>
                  </div>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-md-8 mb-4">
                <div class="card">
                  <div class="card-header">Recent Property Listings</div>
                  <ul class="list-group list-group-flush">
                    <li class="list-group-item">
                      <i class="bi bi-house-door me-2"></i>
                      3 BHK Apartment in City Center - $250,000
                    </li>
                    <li class="list-group-item">
                      <i class="bi bi-house me-2"></i>
                      4 BHK Villa with Pool - $500,000
                    </li>
                    <li class="list-group-item">
                      <i class="bi bi-building me-2"></i>
                      Commercial Space in Business Park - $1,000,000
                    </li>
                    <li class="list-group-item">
                      <i class="bi bi-house-door me-2"></i>
                      2 BHK Condo with Sea View - $180,000
                    </li>
                    <li class="list-group-item">
                      <i class="bi bi-house me-2"></i>
                      5 BHK Luxury Penthouse - $750,000
                    </li>
                  </ul>
                </div>
              </div>
              <div class="col-md-4 mb-4">
                <div class="card">
                  <div class="card-header">Quick Actions</div>
                  <div class="card-body">
                    <div class="d-grid gap-2">

                      <!-- Add Property Button -->

                      <button class="btn btn-danger" type="button">
                        <i class="bi bi-plus-circle me-2"></i> Add Property
                      </button>

                      <button class="btn btn-success" type="button">
                        <i class="bi bi-person-plus me-2"></i>Add New Client
                      </button>
                      <button class="btn btn-info" type="button">
                        <i class="bi bi-calendar-event me-2"></i>Schedule
                        Viewing
                      </button>
                      <button class="btn btn-warning" type="button">
                        <i class="bi bi-file-earmark-text me-2"></i>Generate
                        Report
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>



        <!-- property manage Tab -->
        <div class="tab-pane fade" id="Property" role="tabpanel">
          <div class="mt-4">
            <div class="container mt-4">
              <h3 class="mb-4">Property Management</h3>

              <div class="card">
                <div class="card-header">
                  <div class="row ">


                    <!-- <div class="col-md-6">
                      <input type="text" class="form-control" placeholder="Search properties..." />
                    </div> -->

                    <div class="col-md-6">
                      <input type="text" class="form-control" placeholder="Search properties..."
                        (input)="onSearch($event)" />
                    </div>

                    <div class="col-md-2">
                      <button class="btn btn-primary">
                        <i class="bi bi-search"></i> Search
                      </button>
                    </div>

                    <div class="col-md-2">

                      <button class="btn btn-primary w-100" data-bs-toggle="modal" data-bs-target="#addPropertyModal">
                        <i class="bi bi-plus-circle me-2"></i> Add Property
                      </button>

                    </div>
                  </div>
                </div>

                <div class="card-body">
                  <div class="table-responsive" style="height: 500px; overflow-y: auto;">

                    <table class="table table-striped">
                      <thead>
                        <tr>
                          <th>ID</th>
                          <th>Title</th>
                          <th>Category</th>
                          <th>Size</th>
                          <th>Price</th>
                          <th>Year Built</th>
                          <th>Location</th>
                          <th>bedrooms</th>
                          <th>bathrooms</th>
                          <th>Status</th>
                          <th>Actions</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr *ngFor="let property of filteredProperties">
                          <td>{{ property.propertyId }}</td>
                          <td>{{ property.title }}</td>
                          <td>{{ property.propertyType }}</td>
                          <td>{{ property.size }}</td>
                          <td>{{ property.price }}</td>
                          <td>{{ property.yearBuilt }}</td>
                          <td>{{ property.address }}</td>
                          <td>{{ property.bedrooms }}</td>
                          <td>{{ property.bathrooms }}</td>
                          <td>{{ property.status }}</td>
                          <td>

                            <!-- <butto class="btn btn-primary btn-sm me-1">View</butto
                              n> -->
                            <button class="btn btn-primary btn-sm me-1" (click)="viewProperty(property.propertyId!)"
                              data-bs-toggle="modal" data-bs-target="#viewPropertyModal">
                              View
                            </button>

                            <button class="btn btn-success btn-sm me-1" (click)="loadProperty(property.propertyId!)"
                              data-bs-toggle="modal" data-bs-target="#updatePropertyModal">
                              Update
                            </button>

                            <button class="btn btn-danger btn-sm me-1"
                              (click)="deleteProperty(property.propertyId!)">Delete</button>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>

              </div>


              <!--! // Bootstrap Modal for Adding Property //=======================  -->

              <div class="modal fade" id="addPropertyModal" tabindex="-1" aria-hidden="true">
                <div class="modal-dialog modal-lg">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title">Add New Property</h5>
                      <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">

                      <form [formGroup]="propertyForm" (ngSubmit)="onSubmit()" enctype="multipart/form-data">
                        <div class="mb-3">
                          <label class="form-label">Title</label>
                          <input type="text" class="form-control" formControlName="title" required>
                        </div>

                        <div class="mb-3">
                          <label class="form-label">Price</label>
                          <input type="number" class="form-control" formControlName="price" required>
                        </div>

                        <div class="mb-3">
                          <label class="form-label">Size</label>
                          <input type="number" class="form-control" formControlName="size" required>
                        </div>

                        <div class="mb-3">
                          <label class="form-label">Address</label>
                          <input type="text" class="form-control" formControlName="address"
                            placeholder="Enter Address : Street: 123 Main St, City, State, PostalCode, Country"
                            required>
                        </div>

                        <div class="mb-3">
                          <label class="form-label">Year Built</label>
                          <input type="number" class="form-control" formControlName="yearBuilt" required>
                        </div>

                        <div class="mb-3">
                          <label class="form-label">Property Type</label>
                          <select class="form-control" formControlName="propertyType" required>
                            <option value="" disabled selected>Select Property Type</option>
                            <option value="Resdental">Resdental</option>
                            <option value="Industrial">Industrial</option>
                            <option value="Commercial">Commercial</option>
                            <option value="Land">Land</option>
                          </select>
                        </div>

                        <div class="mb-3">
                          <label class="form-label">Bedrooms</label>
                          <input type="number" class="form-control" formControlName="bedrooms" required>
                        </div>

                        <div class="mb-3">
                          <label class="form-label">Bathrooms</label>
                          <input type="number" class="form-control" formControlName="bathrooms" required>
                        </div>

                        <div class="mb-3">
                          <label class="form-label">Amenities (Comma Separated)</label>
                          <input type="text" class="form-control" formControlName="amenities">
                        </div>

                        <div class="mb-3">
                          <label class="form-label">Features</label>
                          <input type="text" class="form-control" formControlName="features">
                        </div>

                        <div class="mb-3">
                          <label class="form-label">Status</label>
                          <select class="form-control" formControlName="status">
                            <option value="ACTIVE">Active</option>
                            <option value="PENDING">Pending</option>
                            <option value="REJECTED">Rejected</option>
                          </select>
                        </div>

                        <div class="mb-3">
                          <label class="form-label">Availability</label>
                          <select class="form-control" formControlName="availability">
                            <option value="AVAILABLE">Available</option>
                            <option value="RENTED">Rented</option>
                            <option value="SOLD">Sold</option>
                          </select>
                        </div>

                        <div class="mb-3">
                          <label class="form-label">Proximity</label>
                          <input type="text" class="form-control" formControlName="proximity">
                        </div>

                        <div class="mb-3">
                          <label class="form-label">Upload Images</label>
                          <input type="file" class="form-control" (change)="onFileSelected($event)" multiple>
                        </div>

                        <button type="submit" class="btn btn-primary">Add Property</button>
                      </form>

                    </div>
                  </div>
                </div>
              </div>


              <!--! // Bootstrap Modal for View Property //=======================  -->


              <!-- View Property Modal -->
              <div class="modal fade" id="viewPropertyModal" tabindex="-1" aria-labelledby="viewPropertyModalLabel"
                aria-hidden="true">
                <div class="modal-dialog">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title" id="viewPropertyModalLabel">Property Details</h5>
                      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                      <p><strong>Title:</strong> {{ selectedProperty?.title }}</p>
                      <p><strong>Category:</strong> {{ selectedProperty?.propertyType }}</p>
                      <p><strong>Size:</strong> {{ selectedProperty?.size }}</p>
                      <p><strong>Price:</strong> {{ selectedProperty?.price }}</p>
                      <p><strong>Year Built:</strong> {{ selectedProperty?.yearBuilt }}</p>
                      <p><strong>Location:</strong> {{ selectedProperty?.address }}</p>
                      <p><strong>Bedrooms:</strong> {{ selectedProperty?.bedrooms }}</p>
                      <p><strong>Bathrooms:</strong> {{ selectedProperty?.bathrooms }}</p>
                      <p><strong>Status:</strong> {{ selectedProperty?.status }}</p>
                    </div>
                    <div class="modal-footer">
                      <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    </div>
                  </div>
                </div>
              </div>


              <!--! // Bootstrap Modal for Update Property //=======================  -->

              <!-- Update Property Modal -->
              <div class="modal fade" id="updatePropertyModal" tabindex="-1" aria-hidden="true">
                <div class="modal-dialog modal-lg">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title">Update Property</h5>
                      <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                      <form [formGroup]="updateForm" (ngSubmit)="updateProperty()">
                        <div class="mb-3">
                          <label class="form-label">Property Title</label>
                          <input type="text" class="form-control" formControlName="title"
                            placeholder="Enter Property Title">
                        </div>

                        <div class="mb-3">
                          <label class="form-label">Address</label>
                          <input type="text" class="form-control" formControlName="address" placeholder="Enter Address">
                        </div>

                        <div class="mb-3">
                          <label class="form-label">Price</label>
                          <input type="number" class="form-control" formControlName="price" placeholder="Enter Price">
                        </div>

                        <div class="mb-3">
                          <label class="form-label">Size (sq ft)</label>
                          <input type="number" class="form-control" formControlName="size" placeholder="Enter Size">
                        </div>

                        <div class="mb-3">
                          <label class="form-label">Year Built</label>
                          <input type="number" class="form-control" formControlName="yearBuilt"
                            placeholder="Enter Year Built">
                        </div>

                        <div class="mb-3">
                          <label class="form-label">Property Type</label>
                          <select class="form-control" formControlName="propertyType">
                            <option value="Apartment">Apartment</option>
                            <option value="House">House</option>
                            <option value="Villa">Villa</option>
                            <option value="Commercial">Commercial</option>
                          </select>
                        </div>

                        <div class="mb-3">
                          <label class="form-label">Bedrooms</label>
                          <input type="number" class="form-control" formControlName="bedrooms"
                            placeholder="Enter Bedrooms">
                        </div>

                        <div class="mb-3">
                          <label class="form-label">Bathrooms</label>
                          <input type="number" class="form-control" formControlName="bathrooms"
                            placeholder="Enter Bathrooms">
                        </div>

                        <div class="mb-3">
                          <label class="form-label">Features</label>
                          <input type="text" class="form-control" formControlName="features"
                            placeholder="Enter Features">
                        </div>

                        <div class="mb-3">
                          <label class="form-label">Amenities</label>
                          <input type="text" class="form-control" formControlName="amenities"
                            placeholder="Comma separated amenities">
                        </div>

                        <div class="mb-3">
                          <label class="form-label">Proximity</label>
                          <input type="text" class="form-control" formControlName="proximity"
                            placeholder="Enter Proximity Details">
                        </div>

                        <div class="mb-3">
                          <label class="form-label">Status</label>
                          <select class="form-control" formControlName="status">
                            <option value="ACTIVE">ACTIVE</option>
                            <option value="SOLD">SOLD</option>
                            <option value="PENDING">PENDING</option>
                          </select>
                        </div>

                        <div class="mb-3">
                          <label class="form-label">Upload Images</label>
                          <input type="file" class="form-control" (change)="onFileSelected($event)" multiple>
                        </div>

                        <button type="submit" class="btn btn-success">Update Property</button>
                      </form>
                    </div>
                  </div>
                </div>
              </div>
